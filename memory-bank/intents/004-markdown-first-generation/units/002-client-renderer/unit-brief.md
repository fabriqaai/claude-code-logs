---
unit: 002-client-renderer
intent: 004-markdown-first-generation
phase: inception
status: ready
created: 2026-01-17T16:30:00Z
updated: 2026-01-17T16:30:00Z
---

# Unit Brief: Client Renderer

## Purpose

Create an HTML shell with embedded JavaScript that loads Markdown files via fetch, renders them using marked.js + highlight.js, and provides download/copy buttons. Preserves the existing UI/UX exactly.

## Scope

### In Scope
- HTML shell template (sidebar, CSS, JS loader)
- JavaScript to fetch and render MD files
- marked.js integration for MD parsing
- highlight.js integration for code syntax highlighting
- Download as Markdown button
- Copy as Markdown button (with frontmatter)
- Preserve all existing styling and behavior

### Out of Scope
- MD file generation (Unit 1)
- Backend changes (Unit 1)
- New UI features beyond download/copy buttons

---

## Assigned Requirements

| FR | Requirement | Priority |
|----|-------------|----------|
| FR-4 | Client-Side Markdown Rendering | Must |
| FR-5 | Download as Markdown Button | Should |
| FR-6 | Copy as Markdown Button | Should |

---

## Domain Concepts

### Key Entities

| Entity | Description | Attributes |
|--------|-------------|------------|
| HTMLShell | Template with sidebar + JS | CSS, sidebar HTML, loader JS |
| MDRenderer | Client-side MD processor | marked.js config, highlight.js |
| ActionButtons | Download/Copy UI elements | button HTML, event handlers |

### Key Operations

| Operation | Description | Inputs | Outputs |
|-----------|-------------|--------|---------|
| FetchMarkdown | Load MD file via fetch | URL | MD content string |
| RenderMarkdown | Parse MD to HTML | MD string | HTML string |
| HighlightCode | Apply syntax highlighting | code block | highlighted HTML |
| DownloadMD | Trigger file download | MD content, filename | browser download |
| CopyMD | Copy to clipboard | MD content | clipboard |

---

## Story Summary

| Metric | Count |
|--------|-------|
| Total Stories | 3 |
| Must Have | 1 |
| Should Have | 2 |
| Could Have | 0 |

### Stories

| Story ID | Title | Priority | Status |
|----------|-------|----------|--------|
| 001-md-rendering | Client-Side Markdown Rendering | Must | Planned |
| 002-download-button | Download as Markdown Button | Should | Planned |
| 003-copy-button | Copy as Markdown Button | Should | Planned |

---

## Dependencies

### Depends On
| Unit | Reason |
|------|--------|
| 001-markdown-generator | Needs MD files to render |

### Depended By
| Unit | Reason |
|------|--------|
| None | End of chain |

### External Dependencies
| System | Purpose | Risk |
|--------|---------|------|
| marked.js | MD parsing | Low (CDN/bundled) |
| highlight.js | Code highlighting | Low (CDN/bundled) |

---

## Technical Context

### Suggested Technology
- HTML5 + CSS (existing styles)
- Vanilla JavaScript (no framework)
- marked.js (from CDN or bundled)
- highlight.js (from CDN or bundled)

### Integration Points
| Integration | Type | Protocol |
|-------------|------|----------|
| MD files | HTTP | fetch() |
| marked.js | JS lib | import/CDN |
| highlight.js | JS lib | import/CDN |
| Clipboard API | Browser | navigator.clipboard |

### Data Storage
| Data | Type | Volume | Retention |
|------|------|--------|-----------|
| None | N/A | N/A | N/A |

---

## Constraints

- Must preserve exact UI/UX of current HTML output
- Must work offline (CDN with fallback or bundled)
- Render time < 100ms for typical session
- GFM support required (tables, task lists, code fences)

---

## Success Criteria

### Functional
- [ ] MD files render correctly with styling
- [ ] Code blocks have syntax highlighting
- [ ] Download button downloads .md file
- [ ] Copy button copies MD with frontmatter
- [ ] All existing UI features work (sidebar, search, tree)

### Non-Functional
- [ ] Render time < 100ms
- [ ] Works offline

### Quality
- [ ] Visual regression test passes
- [ ] Cross-browser testing (Chrome, Firefox, Safari)
- [ ] Code reviewed

---

## Bolt Suggestions

| Bolt | Type | Stories | Objective |
|------|------|---------|-----------|
| bolt-002-renderer | DDD | S1, S2, S3 | Complete client renderer |

---

## Notes

The HTML shell will be generated by Go (like current templates) but the session content will be loaded dynamically. The shell includes the sidebar, CSS, and JS - only the message content area is dynamic.
