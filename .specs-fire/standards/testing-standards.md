# Testing Standards

## Overview

Testing standards for claude-code-logs CLI tool. Focus on unit tests for core parsing/search logic and integration tests for HTTP API endpoints.

## Testing Framework

**Framework**: Go standard testing
**Runner**: `go test`

## Test Types

| Type | Tool | Location | When to Use |
|------|------|----------|-------------|
| Unit | `testing` | `*_test.go` (same package) | Core logic: parsing, search, tokenization |
| Integration | `testing` + `net/http/httptest` | `server_test.go` | API endpoints, HTTP handlers |
| Table-driven | `testing` | `*_test.go` | Multiple input/output scenarios |

## Coverage Requirements

**Target**: 70%
**Enforcement**: Manual review (no CI gate currently)

**Critical paths that MUST have coverage:**
- JSONL parsing (`ParseJSONL`)
- Search index building and querying
- Token extraction and highlighting
- API response formatting

## Test Naming

**Pattern**: `Test<Function>_<Scenario>`

**Examples**:
- `TestParseJSONL_ValidInput` — Tests successful parsing of valid JSONL
- `TestSearch_PhraseMatching` — Tests quoted phrase search
- `TestHighlightMatches_MultipleTerms` — Tests highlight with multiple terms

## Test Structure

```go
func TestFunctionName_Scenario(t *testing.T) {
    // Arrange
    input := setupTestData()
    expected := expectedResult()

    // Act
    result := FunctionUnderTest(input)

    // Assert
    if result != expected {
        t.Errorf("got %v, want %v", result, expected)
    }
}
```

## Mock Strategy

**Approach**: Minimal mocking, prefer real implementations

**Guidelines**:
- Use `httptest.NewServer` for HTTP testing
- Create test fixtures as string literals or temp files
- Avoid mocking file system - use temp directories
- Mock time only when testing time-dependent logic

## Test Data

**Strategy**: Inline fixtures with realistic data

**Guidelines**:
- Use representative JSONL snippets for parser tests
- Keep test data minimal but realistic
- Document any magic values in test data
- Clean up temp files in test cleanup

## Running Tests

```bash
# Run all tests
go test ./...

# Run with coverage
go test -cover ./...

# Run specific test file
go test -run TestSearch ./...

# Run in watch mode
# (use external tool like `watchexec`)
watchexec -e go "go test ./..."
```

## CI/CD Integration

CI/CD integration not configured.

---
*Generated by FIRE project-init*
